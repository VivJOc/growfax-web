<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Growfax Official</title>
<link rel="icon" href="Growfax_banner.jpg" type="image/jpeg">
<style>
  /* ============================================================
     Growfax Official ‚Äî FULL UI stylesheet (futuristic neon/fax)
     - Mobile-First Optimization Applied (Fixed Horizontal Scrolling)
     ============================================================ */

  /* Global Reset: Ensure padding/border don't cause overflow */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  /* NEW: Keyframes for Logo Animation */
  @keyframes pulse {
    0% { transform: scale(1); box-shadow: var(--logo-shadow); }
    50% { transform: scale(1.02); box-shadow: var(--logo-shadow-hover); }
    100% { transform: scale(1); box-shadow: var(--logo-shadow); }
  }

  :root{
    --bg:#f8f8f8;
    --card-bg:#fff;
    --text:#1a1a1a;
    --accent:#0078d7;
    --card-shadow:0 8px 20px rgba(0,0,0,0.08);
    --discord-color:#7289da;
    --muted:#667;
    --toast-bg:rgba(0,0,0,0.8);
    --glass: rgba(255,255,255,0.6);
    --success:#2ecc71;
    --danger:#e74c3c;
    --mono: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    --border-color: rgba(0,0,0,0.08);

    /* UPDATED: Custom properties for YELLOW glow effect in light mode */
    --glow-color-light: rgba(255, 193, 7, 0.6); /* soft yellow glow */
    --text-shadow-light: 0 0 10px var(--glow-color-light), 0 2px 4px rgba(0,0,0,0.2);
    --logo-shadow: 0 4px 12px rgba(0,0,0,0.12), 0 2px 6px rgba(0,0,0,0.08);
    --logo-shadow-hover: 0 8px 20px rgba(255, 193, 7, 0.4);
  }
  [data-theme="dark"]{
    --bg:#0f1720;
    --card-bg:#0b1220;
    --text:#e6eef8;
    --accent:#4da3ff;
    --card-shadow:0 8px 28px rgba(0,0,0,0.6);
    --discord-color:#5b6ea6;
    --muted:#9aa;
    --toast-bg:rgba(255,255,255,0.08);
    --glass: rgba(255,255,255,0.03);
    --border-color: rgba(255,255,255,0.06);

    /* UPDATED: Custom properties for YELLOW glow effect in dark mode */
    --glow-color-dark: rgba(255, 170, 0, 0.8); /* brighter gold glow */
    --text-shadow-dark: 0 0 12px var(--glow-color-dark), 0 2px 8px rgba(0,0,0,0.6);
    --logo-shadow: 0 6px 18px rgba(0,0,0,0.4), 0 3px 9px rgba(0,0,0,0.25);
    --logo-shadow-hover: 0 10px 25px rgba(255, 170, 0, 0.5);
  }

  html,body{
    height:100%;
    margin:0;
    font-family:var(--mono);
    background:var(--bg);
    color:var(--text);
    line-height:1.6;
    transition:background .25s,color .25s;
    overflow-x: hidden;
  }
  
  /* -------------------------
     Header / Navigation (Optimasi Mobile)
     ------------------------- */
  header{background:var(--card-bg);box-shadow:var(--card-shadow);position:sticky;top:0;z-index:1200}
  .header-content{
    max-width:1100px;
    margin:0 auto;
    padding:14px 10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    flex-wrap: wrap; 
  }
  .header-left{
    display:flex;
    align-items:center;
    gap:8px; 
    flex: 1 1 50%;
  }
  .brand-wrap{display:flex;align-items:center;gap:8px}
  
  /* Glow, lift, and Pulse Animation for logo image */
  .brand-wrap img{
    width:36px;
    height:36px;
    border-radius:6px;
    object-fit:cover;
    transition: box-shadow .25s, transform .25s, opacity 0.2s ease;
    box-shadow: var(--logo-shadow);
    /* Apply animation */
    animation: pulse 3s infinite ease-in-out;
  }

  h1{
    font-size:1.2rem;
    margin:0;
    font-weight:700;
    /* Added opacity transition for smoother language change */
    transition: text-shadow .25s, opacity 0.2s ease;
    color: var(--text);
    text-shadow: var(--text-shadow-light); 
  }
  [data-theme="dark"] h1 {
    text-shadow: var(--text-shadow-dark); 
  }

  .brand-wrap > div > div { 
    font-size: 0.75rem; 
    /* Added opacity transition for smoother language change */
    transition: opacity 0.2s ease;
  }

  nav.primary{
    color:var(--accent);
    text-decoration:none;
    font-weight:700;
    margin-left:auto; 
    font-size: 0.9rem;
    flex: 1 1 100%; 
    margin-top: 8px; 
    text-align: left;
  }
  nav.primary a{
      color:var(--accent);
      text-decoration:none;
      font-weight:700;
      margin-left:0;
      margin-right: 12px;
      /* Added opacity transition for smoother language change */
      transition: opacity 0.2s ease, transform .18s;
  }
  nav.primary a:hover{opacity:.86;transform:translateY(-1px)}
  
  .controls{
    display:flex;
    align-items:center;
    gap:6px;
    flex: 0 1 auto;
  }
  /* Gaya untuk semua tombol kontrol di header */
  .theme-toggle,.lang-select,.open-welcome, .report-bug-btn {
    font-size:0.9rem;
    padding:6px 8px;
    border-radius:8px;
    border:1px solid var(--border-color);
    background:transparent;
    color:var(--text);
    cursor:pointer;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 4px;
    /* Added opacity transition for smoother language change */
    transition: background-color .15s, opacity 0.2s ease;
  }
  .report-bug-btn:hover, .theme-toggle:hover, .open-welcome:hover {
    background: rgba(0,0,0,0.05);
  }
  [data-theme="dark"] .report-bug-btn:hover, [data-theme="dark"] .theme-toggle:hover, [data-theme="dark"] .open-welcome:hover {
    background: rgba(255,255,255,0.05);
  }

  /* -------------------------
     Banner / Hero
     ------------------------- */
  .banner-section{text-align:center;padding:40px 10px;background:linear-gradient(90deg, rgba(0,0,0,0.03), rgba(255,255,255,0.02))}
  .banner-section img{max-width:200px;border-radius:8px;margin-bottom:14px}
  .banner-section h2{
    font-size:1.6rem;
    color:#ffaa00;
    margin:8px 0;
    text-shadow:0 0 10px rgba(255,170,0,0.18);
    transition: opacity 0.2s ease;
  }
  .banner-section p{
    font-size:0.95rem;
    opacity:.92;
    margin:0;
    transition: opacity 0.2s ease;
  }
  .time-display{
    margin-top:8px;
    font-size:0.85rem;
    font-weight:600;
    opacity:.9;
    transition: opacity 0.2s ease;
  }

  /* -------------------------
     Event Section (NEW)
     ------------------------- */
  .event-section{
    max-width:1000px; /* Match main container width */
    margin:32px auto 0;
    padding:20px 10px;
    border-radius:10px;
    background:var(--card-bg);
    box-shadow:var(--card-shadow);
    text-align:left;
    transition: background .25s, box-shadow .25s, opacity 0.2s ease; 
  }
  .event-section h3{
      margin:0 0 10px 0;
      font-size:1.2rem;
      color:var(--accent);
      /* Added glow effect for event name */
      text-shadow: 0 0 8px rgba(0, 120, 215, 0.4); 
      transition: opacity 0.2s ease, text-shadow 0.25s;
  }
  [data-theme="dark"] .event-section h3{
      text-shadow: 0 0 10px rgba(77, 163, 255, 0.6); 
  }

  .event-details{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      flex-wrap: wrap;
      gap: 15px;
      padding: 0 5px;
  }
  .event-details > div {
      flex-basis: 100%; /* Full width on mobile */
      transition: opacity 0.2s ease;
  }
  .event-details strong{
      font-weight:700;
      color:var(--text);
      display:block;
      margin-bottom: 4px;
      font-size: 0.9rem;
      transition: opacity 0.2s ease;
  }
  .event-details span{
      font-size:1.0rem;
      color:var(--muted);
      font-weight: 600;
      transition: opacity 0.2s ease;
  }
  #eventCountdown{
      font-size:1.3rem;
      font-weight:bold;
      color:var(--success);
      text-align: center;
      flex-basis: 100%;
      margin-top: 15px;
      padding: 5px 0;
      border-top: 1px solid var(--border-color);
      transition: color 0.5s ease, opacity 0.2s ease;
  }

  /* -------------------------
     Container (main content)
     ------------------------- */
  .container{max-width:1000px;margin:32px auto;text-align:center;padding:0 10px}
  .container h2{
    font-size:1.4rem;
    margin-bottom:24px;
    transition: opacity 0.2s ease;
  }
  
  /* Platform Buttons: Full width for mobile */
  .platform-buttons{display:flex;flex-wrap:wrap;justify-content:center;gap:14px}
  .platform-buttons a{
    display:flex;align-items:center;justify-content:center;gap:12px;
    width:92%; 
    padding:14px 18px;border-radius:12px;color:#fff;font-weight:700;
    text-decoration:none;border:1px solid transparent;font-size:1.02rem;
    transition:transform .18s ease,box-shadow .18s, opacity 0.2s ease;
  }
  .platform-buttons a img{width:30px;height:30px;border-radius:6px}
  .platform-buttons a:hover{transform:translateY(-2px)}

  .btn-android{background:#34c759;--glow:#4cff77;box-shadow:0 4px 16px rgba(76,255,119,0.08)}
  .btn-windows{background:#0078d7;--glow:#4da3ff;box-shadow:0 4px 16px rgba(77,163,255,0.08)}
  .btn-ios{background:#007aff;--glow:#7acbff;box-shadow:0 4px 16px rgba(122,203,255,0.08)}
  .btn-powertunnel{background:#b71c1c;--glow:#ff5a5a;box-shadow:0 4px 16px rgba(255,90,90,0.08)}

  /* -------------------------
     Discord Section
     ------------------------- */
  .discord-section{background:var(--discord-color);color:#fff;padding:24px;border-radius:10px;max-width:820px;margin:32px auto 50px;text-align:center;box-shadow:var(--card-shadow)}
  .discord-section img{width:48px;height:48px;border-radius:8px;margin-bottom:8px}
  .discord-section h3, .discord-section p, .discord-section a {
    transition: opacity 0.2s ease;
  }

  /* -------------------------
     Footer
     ------------------------- */
  footer{
    text-align:center;
    margin:30px 0 40px;
    font-size:.85rem;
    opacity:.85;
    transition: opacity 0.2s ease;
  }

  /* -------------------------
     Modal & Welcome Popup
     ------------------------- */
  .modal-backdrop, .welcome-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:1300}
  .modal, .welcome{width:92%;max-width:560px;background:var(--card-bg);color:var(--text);border-radius:12px;padding:16px;box-shadow:0 14px 40px rgba(0,0,0,0.2);transform:translateY(0);transition:transform .18s,opacity .18s}
  
  /* Added opacity transition to modal/welcome text elements */
  .modal h3, .modal p, .modal .changelog, .welcome h2, .welcome p, .welcome label, .welcome button {
      transition: opacity 0.2s ease;
  }

  /* -------------------------
     Floating Discord button
     ------------------------- */
  .floating-chat{position:fixed;right:12px;bottom:12px;width:48px;height:48px;border-radius:50%;background:var(--discord-color);display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.2);cursor:pointer;z-index:1500}
  .floating-chat img{width:24px;height:24px;border-radius:4px}

  /* -------------------------
     Toast message
     ------------------------- */
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:70px;background:var(--toast-bg);color:#fff;padding:8px 12px;border-radius:10px;opacity:0;pointer-events:none;transition:opacity .18s,transform .18s;z-index:1600}
  
  /* ===========================
     PC/Desktop Optimizations (Min-width 600px)
     =========================== */
  @media (min-width: 600px) {
    /* Header/Nav kembali ke ukuran besar */
    .header-content {
        flex-wrap: nowrap;
        align-items: center;
        padding: 14px 20px;
    }
    /* Logo size PC */
    .brand-wrap img{width:46px;height:46px;border-radius:8px}
    /* H1 size PC */
    h1{font-size:1.4rem;}
    .brand-wrap > div > div { font-size: 0.85rem; }
    nav.primary {
        flex: 0 1 auto; 
        margin-top: 0;
        margin-left: 12px; 
        text-align: left;
    }
    nav.primary a{
        margin-left:12px;
        margin-right: 0;
        font-size: 1rem;
    }
    .controls{gap:10px}
    /* Ukuran PC untuk semua tombol kontrol */
    .theme-toggle,.lang-select,.open-welcome, .report-bug-btn {
        font-size:0.98rem;
        padding:8px 12px;
        border-radius: 10px;
    }

    /* Event Section PC */
    .event-section {
        padding: 20px 20px;
    }
    .event-details {
        padding: 0 10px;
    }
    .event-details > div {
        flex-basis: 30%; /* Less than half to fit 3 items */
    }
    #eventCountdown{
        font-size: 1.5rem;
        margin-top: 10px;
    }

    /* Tombol Unduhan kembali ke layout 300px */
    .platform-buttons{gap:20px}
    .platform-buttons a{
      width:300px; 
    }
    .platform-buttons a:hover{transform:translateY(-4px)}

    /* Banner/Content padding besar */
    .banner-section{padding:56px 20px;}
    .banner-section img{max-width:240px;border-radius:10px;}
    .banner-section h2{font-size:1.9rem;}
    .container{margin:48px auto;padding:0 18px}
    .container h2{font-size:1.6rem;margin-bottom:28px}
    .discord-section{padding:32px;margin:42px auto 60px;}

    /* Floating button kembali ke posisi normal */
    .floating-chat{right:18px;bottom:18px;width:56px;height:56px;}
    .floating-chat img{width:28px;height:28px;}
    .toast{bottom:86px;}
  }
</style>
</head>
<body data-theme="light">
  <header>
    <div class="header-content">
      <div class="header-left">
        <div class="brand-wrap">
          <img src="Growfax_banner.jpg" alt="Growfax Logo">
          <div>
            <h1>Growfax Official</h1>
            <div style="font-size:0.85rem;color:var(--muted)">Private Growtopia Server</div>
          </div>
        </div>

        <nav class="primary" aria-label="Main navigation">
          <a href="#downloads" id="navDownloads">üì• Downloads</a>
        </nav>
      </div>

      <div class="controls">
        <a href="#" 
           id="reportBugLink" 
           class="report-bug-btn" 
           title="Report a Bug">üêû Report Bug</a>
        
        <button id="openWelcome" class="open-welcome" title="Welcome & Preferences">‚öôÔ∏è</button>
        
        <select id="langSelect" class="lang-select" title="Language" aria-label="Select language">
          <option value="en">üá¨üáß English</option>
          <option value="id">üáÆüá© Bahasa</option>
        </select>
        <button id="themeToggle" class="theme-toggle" aria-pressed="false" title="Toggle theme">üåû Light</button>
      </div>
    </div>
  </header>

  <section class="banner-section" role="region" aria-label="Main banner">
    <img src="Growfax_banner.jpg" alt="Growfax Banner">
    <h2>Welcome to Growfax</h2>
    <p>Private Growtopia Server</p>
    <div id="timeDisplay" class="time-display">Loading time...</div>
  </section>
  
  <section id="event-display" class="event-section" role="region" aria-label="Current Growfax Event">
    <div style="text-align: center; color: var(--muted);">Loading event schedule...</div>
  </section>

  <main class="container" id="downloads" role="main">
    <h2>üì• Essential File Downloads</h2>
    <div class="platform-buttons" role="list">
      <a href="Growfax_VirtualHost.txt" class="btn-android" data-filename="Growfax_VirtualHost.txt" data-filekey="virtualhost" download role="listitem">
        <img src="virtual-host.png" alt="">Play on Android
      </a>

      <a href="Growfax_Patched_.bat" class="btn-windows" data-filename="Growfax_Patched_.bat" data-filekey="patched" download role="listitem">
        <img src="windows.png" alt="">Play on Windows
      </a>

      <a href="GrowFax_ios.txt" class="btn-ios" data-filename="GrowFax_ios.txt" data-filekey="ios" download role="listitem">
        <img src="surge5.png" alt="">Play on iOS
      </a>

      <a href="#" class="btn-powertunnel" data-filename="PowerTunnel_Host.txt" data-filekey="powertunnel" role="listitem">
        <img src="powertunnel.jpeg" alt="">Play via PowerTunnel
      </a>
    </div>
  </main>

  <section class="discord-section" aria-label="Discord community">
    <img src="discord.jpeg" alt="Discord Logo">
    <h3>Join Our Community</h3>
    <p>Connect with others and get support in our official Discord server.</p>
    <a id="discordLink" href="https://discord.gg/smgS6sq83y" target="_blank" rel="noopener">Join Growfax Discord</a>
  </section>

  <footer>¬© 2025 Growfax. All rights reserved.</footer>

  <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <h3 id="modalTitle">File info</h3>
      <p id="modalDesc">Details before download</p>

      <div class="meta">
        <div class="chip" id="modalVersion">v0.0</div>
        <div class="chip" id="modalUpdated">Updated: ‚Äî</div>
      </div>

      <div class="changelog" id="modalChangelog">Changelog: ‚Äî</div>

      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
        <div style="font-size:.9rem;color:var(--muted)" id="modalFilename">Filename</div>
        <div class="buttons">
          <button class="btn secondary" id="modalCancel">Cancel</button>
          <button class="btn primary" id="modalConfirm">Download</button>
        </div>
      </div>
    </div>
  </div>

  <div id="welcomeBackdrop" class="welcome-backdrop" aria-hidden="true">
    <div class="welcome" role="dialog" aria-modal="true" aria-labelledby="welcomeTitle">
      <h2 id="welcomeTitle">Welcome to Growfax</h2>
      <p style="margin:6px 0 12px;opacity:.9">Set your preferred language and theme. We'll remember this for next time.</p>
      <div class="row">
        <label for="welcomeLang">Language</label>
        <select id="welcomeLang" class="lang-select">
          <option value="en">üá¨üáß English</option>
          <option value="id">üáÆüá© Bahasa</option>
        </select>
      </div>
      <div class="row">
        <label>Theme</label>
        <div style="display:flex;gap:10px;align-items:center">
          <label><input type="radio" name="welcomeTheme" value="light" checked> Light</label>
          <label><input type="radio" name="welcomeTheme" value="dark"> Dark</label>
        </div>
      </div>

      <div class="actions" style="display:flex;justify-content:flex-end;gap:8px;margin-top:14px">
        <button class="btn secondary" id="welcomeSkip">Skip</button>
        <button class="btn primary" id="welcomeSave">Save & Continue</button>
      </div>
    </div>
  </div>

  <a id="floatingChat" class="floating-chat" href="https://discord.gg/smgS6sq83y" target="_blank" rel="noopener" title="Open Discord">
    <img src="discord.jpeg" alt="Discord">
  </a>

  <div id="toast" class="toast" role="status" aria-live="polite">Saved</div>

<script>
/* ============================================================
   Growfax Official ‚Äî FULL script
   ============================================================ */

/* ===========================
   Core refs & state
   =========================== */
const langSelect = document.getElementById('langSelect');
const themeToggle = document.getElementById('themeToggle');
const openWelcome = document.getElementById('openWelcome');
const toast = document.getElementById('toast');
const modalBackdrop = document.getElementById('modalBackdrop');
const modalTitle = document.getElementById('modalTitle');
const modalDesc = document.getElementById('modalDesc');
const modalVersion = document.getElementById('modalVersion');
const modalUpdated = document.getElementById('modalUpdated');
const modalChangelog = document.getElementById('modalChangelog');
const modalFilename = document.getElementById('modalFilename');
const modalConfirm = document.getElementById('modalConfirm');
const modalCancel = document.getElementById('modalCancel');

const welcomeBackdrop = document.getElementById('welcomeBackdrop');
const welcomeLang = document.getElementById('welcomeLang');
const welcomeSave = document.getElementById('welcomeSave');
const welcomeSkip = document.getElementById('welcomeSkip');

const timeDisplay = document.getElementById('timeDisplay');
const discordLink = document.getElementById('discordLink');
const reportBugLink = document.getElementById('reportBugLink');
const eventDisplay = document.getElementById('event-display');

let pendingDownload = null;

/* ===========================
   File metadata
   - PowerTunnel: Copy-text
   =========================== */
const FILE_META = {
  virtualhost: { version: 'v2.1', updated: 'Oct 29, 2025', changelog: '- Fixed host parsing\\n- Improved TLS handling', size: '2.3 KB' },
  patched: { version: 'v1.9', updated: 'Oct 20, 2025', changelog: '- Patched launcher\\n- Minor fixes', size: '12.1 KB' },
  ios: { version: 'v1.4', updated: 'Sep 30, 2025', changelog: '- iOS config update\\n- Surge tweak', size: '3.7 KB' },
  powertunnel: { 
    version: 'v3.0', 
    updated: 'Oct 10, 2025', 
    changelog: 'Instruksi: Teks Host telah disalin secara otomatis ke clipboard Anda. Silakan tempelkan ke konfigurasi PowerTunnel Anda.', 
    size: '1.9 KB',
    copytext: `15.235.232.75 growtopia1.com\n15.235.232.75 growtopia2.com\n15.235.232.75 www.growtopia1.com\n15.235.232.75 www.growtopia2.com`
  }
};

/* ===========================
   Event Schedule Data (NEW)
   - Start time in 24h format (WIB/GMT+7)
   - Duration is 2 hours per event
   =========================== */
const DAILY_EVENTS = [
    { start: 0, name: 'Glowfaxt Hunt', world: 'GLOWHUNT', id_name: 'Perburuan Glowfaxt' },
    { start: 2, name: 'Battle Arena', world: 'ARENA', id_name: 'Arena Pertarungan' },
    { start: 4, name: 'Parkour Challenge', world: 'PARKOUR', id_name: 'Tantangan Parkour' },
    { start: 6, name: 'Quiz Mania', world: 'QUIZ', id_name: 'Kuis Mania' },
    { start: 8, name: 'Fashion Show', world: 'FASHION', id_name: 'Peragaan Busana' },
    { start: 10, name: 'Glowfaxt Hunt', world: 'GLOWHUNT', id_name: 'Perburuan Glowfaxt' },
    { start: 12, name: 'Battle Arena', world: 'ARENA', id_name: 'Arena Pertarungan' },
    { start: 14, name: 'Parkour Challenge', world: 'PARKOUR', id_name: 'Tantangan Parkour' },
    { start: 16, name: 'Quiz Mania', world: 'QUIZ', id_name: 'Kuis Mania' },
    { start: 18, name: 'Fashion Show', world: 'FASHION', id_name: 'Peragaan Busana' },
    { start: 20, name: 'Glowfaxt Hunt', world: 'GLOWHUNT', id_name: 'Perburuan Glowfaxt' },
    { start: 22, name: 'Battle Arena', world: 'ARENA', id_name: 'Arena Pertarungan' }
];


/* ===========================
   Translation baseline
   =========================== */
const elements = document.querySelectorAll('body *:not(script):not(style)');
elements.forEach(el=>{
  // Only store simple text nodes to avoid breaking complex elements
  if (el.childNodes.length === 1 && el.textContent.trim() !== '') {
    el.dataset.original = el.textContent.trim();
  }
});

/* Translation dictionary (expandable) */
const translations = {
  id: {
    "Growfax Official": "Growfax Resmi",
    "üì• Downloads": "üì• Unduhan",
    "Welcome to Growfax": "Selamat Datang di Growfax",
    "Private Growtopia Server": "Server Growtopia Pribadi",
    "Local Time (New York):": "Waktu Lokal (New York):",
    "Waktu Lokal (Jakarta):": "Waktu Lokal (Jakarta):",
    "üì• Essential File Downloads": "üì• Unduhan File Penting",
    "Play on Android": "Main di Android",
    "Play on Windows": "Main di Windows",
    "Play on iOS": "Main di iOS",
    "Play via PowerTunnel": "Main lewat PowerTunnel",
    "Join Our Community": "Bergabung dengan Komunitas Kami",
    "Connect with others and get support in our official Discord server.": "Terhubung dengan anggota lain dan dapatkan dukungan di server Discord resmi kami.",
    "Join Growfax Discord": "Gabung Discord Growfax",
    "¬© 2025 Growfax. All rights reserved.": "¬© 2025 Growfax. Semua hak dilindungi.",
    "Are you sure you want to download": "Apakah Anda yakin ingin mengunduh",
    "Details before download": "Detail sebelum mengunduh",
    "Cancel": "Batal",
    "Download": "Unduh",
    "Filename": "Nama berkas",
    "Version": "Versi",
    "Updated": "Diperbarui",
    "Changelog": "Catatan pembaruan",
    "Size": "Ukuran",
    "Set your preferred language and theme. We'll remember this for next time.": "Pilih bahasa dan tema favoritmu. Kami akan menyimpannya untuk kunjungan berikutnya.",
    "Save & Continue": "Simpan & Lanjutkan",
    "Skip": "Lewati",
    "Language": "Bahasa",
    "Theme": "Tema",
    "Opening Discord...": "Membuka Discord...",
    "üêû Report Bug": "üêû Laporkan Bug",
    
    // NEW Event Translations
    "Current Event": "Event Saat Ini",
    "Next Event": "Event Berikutnya",
    "Event Name": "Nama Event",
    "World": "Dunia",
    "Ends in": "Berakhir dalam",
    "Starts in": "Dimulai dalam",
    "h": "j", // hours
    "m": "m", // minutes
    "s": "d"  // seconds (detik)
  }
};

/* ===========================
   Smooth Translation Logic
   =========================== */
function applyTranslations(lang){
  const transitionDuration = 200; // ms
  const elementsToTranslate = document.querySelectorAll('[data-original], #modalCancel, #modalConfirm, #welcomeSave, #welcomeSkip, #discordLink, #reportBugLink');

  // 1. Fade out (Opacity 0)
  elementsToTranslate.forEach(el => {
    // Only target elements currently visible
    if (el.offsetWidth > 0 || el.offsetHeight > 0 || el === langSelect) {
      el.style.transition = `opacity ${transitionDuration}ms ease`;
      el.style.opacity = '0';
    }
  });

  // 2. Wait for fade-out
  setTimeout(() => {
    // 3. Apply new content (Opacity is 0, so change is invisible)
    elements.forEach(el=>{
      const orig = el.dataset.original;
      if(!orig) return;
      el.textContent = lang === 'en' ? orig : (translations[lang]?.[orig] || orig);
    });

    // Fix buttons/labels manually
    modalCancel.textContent = lang === 'id' ? (translations.id['Cancel'] || 'Batal') : 'Cancel';
    modalConfirm.textContent = lang === 'id' ? (translations.id['Download'] || 'Unduh') : 'Download';
    welcomeSave.textContent = lang === 'id' ? (translations.id['Save & Continue'] || 'Simpan & Lanjutkan') : 'Save & Continue';
    welcomeSkip.textContent = lang === 'id' ? (translations.id['Skip'] || 'Lewati') : 'Skip';
    discordLink.textContent = lang === 'id' ? (translations.id['Join Growfax Discord'] || 'Gabung Discord Growfax') : 'Join Growfax Discord';
    reportBugLink.textContent = lang === 'id' ? (translations.id['üêû Report Bug'] || 'üêû Laporkan Bug') : 'üêû Report Bug';
    
    // Update mailto link and event schedule immediately after translation
    updateReportBugLink(); 
    // Re-run the event scheduler to update event text instantly
    updateEventSchedule(true); 

    // 4. Fade back in (Opacity 1)
    elementsToTranslate.forEach(el => {
      // Restore opacity on elements that were hidden
      if (el.style.opacity === '0') {
        el.style.opacity = '1';
        // Remove inline transition after fade-in to let CSS handle it again
        setTimeout(() => el.style.transition = '', transitionDuration);
      }
    });

  }, transitionDuration); // Delay matches the fade-out duration
}


/* ===========================
   Report Bug Link Logic
   =========================== */
function updateReportBugLink() {
  const lang = langSelect.value;
  let subject, body;
  
  if (lang === 'id') {
    subject = 'Laporan Bug - Growfax';
    body = 'Mohon jelaskan bug yang Anda temukan:\n\n---\nDevice/Platform (Android/iOS/PC):\nWaktu Kejadian:\nLangkah-langkah mereplikasi bug:\n---\n\n(Silakan lampirkan screenshot atau foto di sini. Terima kasih.)';
  } else { // default to 'en'
    subject = 'Bug Report - Growfax';
    body = 'Please describe the bug you encountered:\n\n---\nDevice/Platform (Android/iOS/PC):\nTime of Occurrence:\nSteps to reproduce the bug:\n---\n\n(Please attach screenshots or photos here. Thank you.)';
  }

  // Encode the subject and body for the URL
  const mailtoURL = `mailto:growfaxz.gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  
  reportBugLink.setAttribute('href', mailtoURL);
}


/* ===========================
   Theme control
   =========================== */
function setTheme(theme){
  document.body.setAttribute('data-theme', theme);
  themeToggle.textContent = theme === 'dark' ? 'üåô Dark' : 'üåû Light';
  themeToggle.setAttribute('aria-pressed', theme === 'dark');
  localStorage.setItem('growfax_theme', theme);
}
themeToggle.addEventListener('click', ()=> {
  setTheme(document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
});
setTheme(localStorage.getItem('growfax_theme') || 'light');

/* ===========================
   Language control (persist)
   =========================== */
langSelect.addEventListener('change', ()=> {
  const lang = langSelect.value;
  localStorage.setItem('growfax_lang', lang);
  applyTranslations(lang);
  updateTime();
  showToast(lang === 'id' ? 'Bahasa: Indonesia' : 'Language: English');
});
(function initLang(){
  const saved = localStorage.getItem('growfax_lang') || (navigator.language && navigator.language.startsWith('id') ? 'id' : 'en');
  langSelect.value = saved;
  applyTranslations(saved);
  updateReportBugLink(); // Initial link setup
})();

/* ===========================
   Time display (NY / Jakarta)
   =========================== */
function getIndoGreeting(hour){
  if(hour < 11) return 'pagi';
  if(hour < 15) return 'siang';
  if(hour < 18) return 'sore';
  return 'malam';
}
function updateTime(){
  const now = new Date();
  const lang = langSelect.value || 'en';
  if(lang === 'id'){
    const options = { timeZone: 'Asia/Jakarta', hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit', day: '2-digit', month: '2-digit', year: 'numeric' };
    const indoTime = new Intl.DateTimeFormat('id-ID', options).format(now);
    // Get hour separately using the correct timezone
    const hour = parseInt(now.toLocaleString('en-US', { timeZone: 'Asia/Jakarta', hour: '2-digit', hour12: false }));
    const greeting = getIndoGreeting(hour);
    timeDisplay.textContent = `Waktu Lokal (Jakarta): ${indoTime} - ${greeting}`;
  } else {
    const options = { timeZone: 'America/New_York', hour12: true, timeStyle: 'medium', dateStyle: 'medium' };
    const usTime = now.toLocaleString('en-US', options);
    timeDisplay.textContent = `Local Time (New York): ${usTime}`;
  }
}
updateTime();
setInterval(updateTime, 1000);

/* ===========================
   Event Scheduling Logic (NEW)
   =========================== */

/**
 * Finds the currently running event and the next starting event based on WIB/GMT+7.
 * @param {Date} now - The current Date object (in local time).
 * @returns {{currentEvent: Object|null, nextEvent: Object, endTimestamp: Date, nextStartTimestamp: Date}}
 */
function getCurrentEvent(now){
    // Get current time components in Jakarta time (GMT+7)
    const nowWIB = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Jakarta' }));
    const currentHour = nowWIB.getHours();
    const currentMinutes = nowWIB.getMinutes();
    const currentSeconds = nowWIB.getSeconds();
    
    let currentEvent = null;
    let nextEvent = null;
    let endTimestamp = null;
    let nextStartTimestamp = null;
    
    // Convert current time to seconds since midnight (for easier comparison)
    const nowSecs = (currentHour * 3600) + (currentMinutes * 60) + currentSeconds;
    
    // 1. Find the current running event
    for(let i = 0; i < DAILY_EVENTS.length; i++){
        const event = DAILY_EVENTS[i];
        const eventStartSecs = event.start * 3600;
        const eventEndHour = (event.start + 2) % 24; 
        let eventEndSecs = eventEndHour * 3600;

        // Handle event crossing midnight (e.g., 22:00 to 00:00)
        if (eventEndSecs < eventStartSecs) { 
             if (nowSecs >= eventStartSecs || nowSecs < eventEndSecs) {
                 currentEvent = event;
                 break;
             }
        } else if (nowSecs >= eventStartSecs && nowSecs < eventEndSecs) {
            // Event is running and doesn't cross midnight
            currentEvent = event;
            break;
        }
    }
    
    // 2. Determine timestamps (End of current or Start of next)
    if(currentEvent){
        // Calculate the end time of the current event
        endTimestamp = new Date(nowWIB);
        endTimestamp.setHours(currentEvent.start + 2, 0, 0, 0);

        // If the calculated end time is in the past, it means it's tomorrow (crosses midnight)
        if (endTimestamp.getTime() <= nowWIB.getTime()) {
             endTimestamp.setDate(endTimestamp.getDate() + 1);
        }
        
        // Find the next event in the schedule array
        let currentIndex = DAILY_EVENTS.findIndex(e => e.start === currentEvent.start);
        let nextIndex = (currentIndex + 1) % DAILY_EVENTS.length;
        nextEvent = DAILY_EVENTS[nextIndex];
        
    } else {
        // Find the next upcoming event (Inter-event period, should only happen if event duration is less than 24h cycle)
        for(const event of DAILY_EVENTS){
            if(currentHour < event.start){
                nextEvent = event;
                break;
            }
        }
        // If still null (after 22:00 until 00:00)
        if (!nextEvent) {
            nextEvent = DAILY_EVENTS[0];
        }
    }

    // Calculate the start time of the determined next event (if currentEvent exists, nextEvent is its successor)
    nextStartTimestamp = new Date(nowWIB);
    nextStartTimestamp.setHours(nextEvent.start, 0, 0, 0);
    
    // If the next start time is in the past, it's for tomorrow
    if (nextStartTimestamp.getTime() <= nowWIB.getTime() && currentEvent === null) {
        nextStartTimestamp.setDate(nextStartTimestamp.getDate() + 1);
    }
    // If current event is running, ensure next start time is correct (it might be past if the event just started, but we look forward)
    else if (currentEvent !== null && nextStartTimestamp.getTime() <= nowWIB.getTime()) {
        nextStartTimestamp.setDate(nextStartTimestamp.getDate() + 1);
    }
    
    return { currentEvent, nextEvent, endTimestamp: endTimestamp || nextStartTimestamp, nextStartTimestamp };
}

/**
 * Formats time difference in milliseconds into human-readable string (e.g., 1j 30m 5d).
 */
function formatTimeDifference(diffMs){
    const lang = langSelect.value || 'en';
    const totalSeconds = Math.max(0, Math.floor(diffMs / 1000));
    const hours = Math.floor(totalSeconds / 3600);
    const minutes = Math.floor((totalSeconds % 3600) / 60);
    const seconds = totalSeconds % 60;
    
    let parts = [];
    // Only show hours if > 0
    if(hours > 0) parts.push(`${hours}${(lang === 'id' ? translations.id['h'] : 'h')}`);
    // Show minutes unless hours are present and minutes are 0
    if(minutes > 0 || (hours === 0 && seconds > 0)) parts.push(`${minutes}${(lang === 'id' ? translations.id['m'] : 'm')}`);
    // Always show seconds, but only if minutes and hours are 0, or if total time is < 1 minute
    if(hours === 0 && minutes < 1 && seconds >= 0) {
        parts = []; // Clear previous parts if we only want seconds
        parts.push(`${seconds}${(lang === 'id' ? translations.id['s'] : 's')}`);
    }
    
    if (totalSeconds >= 3600) {
        parts = [`${hours}${lang === 'id' ? 'j' : 'h'}`, `${minutes}${lang === 'id' ? 'm' : 'm'}`, `${seconds}${lang === 'id' ? 'd' : 's'}`].filter((p, i) => i < 2 || (i === 2 && hours === 0 && minutes === 0));
        if (hours === 0) {
           parts = [`${minutes}${lang === 'id' ? 'm' : 'm'}`, `${seconds}${lang === 'id' ? 'd' : 's'}`];
        } else {
           // If hours > 0, show H and M
           parts = [`${hours}${lang === 'id' ? 'j' : 'h'}`, `${minutes}${lang === 'id' ? 'm' : 'm'}`];
        }
    } else if (totalSeconds >= 60) {
        parts = [`${minutes}${lang === 'id' ? 'm' : 'm'}`, `${seconds}${lang === 'id' ? 'd' : 's'}`];
    } else {
        parts = [`${seconds}${lang === 'id' ? 'd' : 's'}`];
    }

    // Fallback for correct formatting
    if (totalSeconds === 0) return '0s';

    return parts.join(' ');
}


/**
 * Updates the Event Schedule display every second.
 * @param {boolean} [forceUpdate=false] - Forces DOM injection, useful for language changes.
 */
let lastEventName = ''; // Global state to track event name changes

function updateEventSchedule(forceUpdate = false){
    const now = new Date();
    const { currentEvent, nextEvent, endTimestamp, nextStartTimestamp } = getCurrentEvent(now);
    const lang = langSelect.value || 'en';
    
    let html = '';
    let countdownMs;
    let countdownTextPrefix;
    let eventName;
    let worldName;
    let isRunning = !!currentEvent;

    if (isRunning) {
        countdownMs = endTimestamp.getTime() - now.getTime();
        countdownTextPrefix = lang === 'id' ? (translations.id['Ends in'] || 'Berakhir dalam') : 'Ends in';
        eventName = lang === 'id' ? (currentEvent.id_name || currentEvent.name) : currentEvent.name;
        worldName = currentEvent.world;
    } else {
        // Next event starts
        countdownMs = nextStartTimestamp.getTime() - now.getTime();
        countdownTextPrefix = lang === 'id' ? (translations.id['Starts in'] || 'Dimulai dalam') : 'Starts in';
        eventName = lang === 'id' ? (nextEvent.id_name || nextEvent.name) : nextEvent.name;
        worldName = nextEvent.world;
    }

    const currentDisplayEventName = `${isRunning ? 'Current' : 'Next'} - ${eventName}`;

    // --- DOM Injection/Update Logic ---
    if (forceUpdate || currentDisplayEventName !== lastEventName) {
        // Only inject new HTML if the event itself has changed or language changed
        html = `
            <h3>${lang === 'id' ? (isRunning ? translations.id['Current Event'] : translations.id['Next Event']) : (isRunning ? 'Current Event' : 'Next Event')}</h3>
            <div class="event-details">
                <div>
                    <strong>${lang === 'id' ? (translations.id['Event Name'] || 'Nama Event') : 'Event Name'}</strong>
                    <span style="color: var(--accent); font-weight: 700;">${eventName}</span>
                </div>
                <div>
                    <strong>${lang === 'id' ? (translations.id['World'] || 'Dunia') : 'World'}</strong>
                    <span style="color: var(--text);">${worldName}</span>
                </div>
            </div>
            <div id="eventCountdown"></div>
        `;
        eventDisplay.innerHTML = html;
        lastEventName = currentDisplayEventName;
    }
    
    // --- Countdown Update Logic ---
    const countdownEl = document.getElementById('eventCountdown');
    if (countdownEl) {
        // Color changes based on remaining time
        let countdownColor;
        if (countdownMs <= (60 * 1000) && isRunning) {
            countdownColor = 'var(--danger)'; // Red (last 1 minute)
        } else if (countdownMs <= (5 * 60 * 1000) && isRunning) {
            countdownColor = '#ff6347'; // Tomato (last 5 minutes)
        } else if (isRunning) {
            countdownColor = 'var(--success)'; // Green/Success
        } else {
            countdownColor = 'var(--accent)'; // Blue for next event
        }
        
        countdownEl.textContent = `${countdownTextPrefix}: ${formatTimeDifference(countdownMs)}`;
        countdownEl.style.color = countdownColor;
    }

    // Set a timeout to run again in 1 second
    setTimeout(() => updateEventSchedule(false), 1000);
}


/* ===========================
   File Update Checker (modal)
   =========================== */
document.querySelectorAll('.platform-buttons a').forEach(a=>{
  a.addEventListener('click', (e)=>{
    // Allow ctrl/meta click (open in new tab) and middle-click
    if(e.ctrlKey || e.metaKey || e.button === 1) return;
    e.preventDefault();
    const key = a.dataset.filekey;
    const meta = FILE_META[key] || { version: 'v1.0', updated: 'Unknown', changelog: 'No details', size: '‚Äî' };
    const filename = a.dataset.filename || key;

    // --- LOGIKA KHUSUS POWERTUNNEL (COPY TEXT) ---
    if (key === 'powertunnel' && meta.copytext) {
        // Teks tersedia, salin ke clipboard
        navigator.clipboard.writeText(meta.copytext).then(() => {
            const toastMessage = (langSelect.value === 'id') ? '‚úÖ Teks Host PowerTunnel berhasil disalin!' : '‚úÖ PowerTunnel Host text copied!';
            showToast(toastMessage, 3000);
        }).catch(err => {
            console.error('Copy failed:', err);
            const toastMessage = (langSelect.value === 'id') ? '‚ùå Gagal menyalin teks!' : '‚ùå Failed to copy text!';
            showToast(toastMessage, 3000);
        });
        return; // Hentikan aksi selanjutnya (tidak perlu modal)
    }
    // --- AKHIR LOGIKA KHUSUS POWERTUNNEL ---

    // Lanjutkan dengan logika modal/download untuk file lain
    modalTitle.textContent = (langSelect.value === 'id') ? (translations.id['Details before download'] || 'Detail sebelum mengunduh') : 'Details before download';
    modalDesc.textContent = (langSelect.value === 'id') ? `Info untuk ${filename}` : `Info for ${filename}`;
    modalVersion.textContent = `${(langSelect.value === 'id') ? (translations.id['Version'] || 'Versi') + ': ' : 'Version: '}${meta.version}`;
    modalUpdated.textContent = `${(langSelect.value === 'id') ? (translations.id['Updated'] || 'Diperbarui') + ': ' : 'Updated: '}${meta.updated}`;
    modalChangelog.innerText = `${(langSelect.value === 'id') ? (translations.id['Changelog'] || 'Catatan pembaruan') + ':' : 'Changelog:'}\n${meta.changelog}\n\n${(langSelect.value === 'id') ? (translations.id['Size'] || 'Ukuran') + ': ' : 'Size: '}${meta.size}`;
    modalFilename.textContent = (langSelect.value === 'id' ? (translations.id['Filename'] || 'Nama berkas') : 'Filename') + `: ${filename}`;
    pendingDownload = { href: a.getAttribute('href'), filename };
    showModal();
  });
});
function showModal(){ modalBackdrop.style.display='flex'; modalBackdrop.setAttribute('aria-hidden','false'); setTimeout(()=>modalConfirm.focus(),200); }
function hideModal(){ modalBackdrop.style.display='none'; modalBackdrop.setAttribute('aria-hidden','true'); pendingDownload=null; }
modalCancel.addEventListener('click', ()=> hideModal());
modalBackdrop.addEventListener('click', (e)=>{ if(e.target===modalBackdrop) hideModal(); });
modalConfirm.addEventListener('click', ()=>{
  if(!pendingDownload) return hideModal();
  const a = document.createElement('a'); a.href = pendingDownload.href; a.download = pendingDownload.filename; document.body.appendChild(a); a.click(); a.remove();
  hideModal(); showToast(langSelect.value === 'id' ? 'Mulai mengunduh...' : 'Download started...');
});

/* ===========================
   Welcome popup
   =========================== */
function showWelcome(){ welcomeBackdrop.style.display='flex'; welcomeBackdrop.setAttribute('aria-hidden','false'); }
function hideWelcome(){ welcomeBackdrop.style.display='none'; welcomeBackdrop.setAttribute('aria-hidden','true'); }
openWelcome.addEventListener('click', ()=> showWelcome());
welcomeSave.addEventListener('click', ()=>{
  const chosenLang = document.getElementById('welcomeLang').value;
  const theme = Array.from(document.querySelectorAll('input[name="welcomeTheme"]')).find(r=>r.checked).value;
  langSelect.value = chosenLang;
  localStorage.setItem('growfax_lang', chosenLang);
  applyTranslations(chosenLang);
  updateTime();
  setTheme(theme);
  hideWelcome();
  showToast(chosenLang === 'id' ? 'Bahasa disimpan' : 'Preferences saved');
});
welcomeSkip.addEventListener('click', ()=> { hideWelcome(); showToast(langSelect.value === 'id' ? 'Dipilih nanti' : 'Maybe later'); });
(function firstVisit(){ const seen = localStorage.getItem('growfax_seen'); if(!seen){ welcomeLang.value = localStorage.getItem('growfax_lang') || (navigator.language && navigator.language.startsWith('id') ? 'id' : 'en'); const savedTheme = localStorage.getItem('growfax_theme') || 'light'; document.querySelectorAll('input[name="welcomeTheme"]').forEach(r=> r.checked = (r.value === savedTheme)); showWelcome(); localStorage.setItem('growfax_seen','1'); }})();

/* ===========================
   Storage helpers & UI helpers
   =========================== */
function showToast(text, ms=1500){
  toast.textContent = text;
  toast.style.opacity = '1';
  toast.style.transform = 'translateX(-50%) translateY(0)';
  toast.style.pointerEvents = 'auto';
  toast.style.display = 'block';
  setTimeout(()=> {
    toast.style.opacity = '0';
    toast.style.pointerEvents = 'none';
    setTimeout(()=> toast.style.display = 'none', 200);
  }, ms);
}

/* floating discord click (toast feedback) */
document.getElementById('floatingChat').addEventListener('click', (e)=>{
  showToast(langSelect.value === 'id' ? 'Membuka Discord...' : 'Opening Discord...');
});

/* ===========================
   Report Bug Link Handler (Optional for toast feedback)
   =========================== */
reportBugLink.addEventListener('click', () => {
  // Hanya berikan feedback toast karena mailto: link sudah diatur
  showToast(langSelect.value === 'id' ? 'Membuka aplikasi email...' : 'Opening email application...');
});

/* ===========================
   Initializations
   =========================== */
const initLang = localStorage.getItem('growfax_lang') || (navigator.language && navigator.language.startsWith('id') ? 'id' : 'en');
langSelect.value = initLang;
applyTranslations(initLang); // This will run updateEventSchedule(true) internally
updateTime();

// Start the event schedule update loop
updateEventSchedule(true); 

/* ===========================
   Misc small UI effects
   =========================== */
// graceful page link transition for all html links
document.querySelectorAll('a').forEach(link => {
  link.addEventListener('click', e => {
    // only internal html
    try {
      const href = link.getAttribute('href');
      if(href && href.endsWith('.html') && !link.hasAttribute('data-no-transition')){
        e.preventDefault();
        document.body.style.opacity = '0';
        setTimeout(() => (window.location.href = href), 300);
      }
    } catch(err){ /* ignore */ }
  });
});

/* ===========================
   Console debug friendly message
   =========================== */
console.log('%cGrowfax Engine Ready ‚úÖ', 'color: #00ff88; font-weight: bold;');

/* END OF SCRIPT */
</script>
</body>
</html>
